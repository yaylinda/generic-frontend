<div class="home-page">

  <div class="banner" *appShowAuthed="false">
    <div class="container">
      <h1 class="logo-font">Simple War</h1>
      <p>Play a friendly game of Simple War!</p>
    </div>
  </div>

  <div class="container page">

    <!-- Logged in content -->
    <div *appShowAuthed="true">

      <!-- Game List -->
      <div *ngIf="!inGameMode" class="content-center">
        <mat-divider></mat-divider>
        <mat-list>
          <mat-list-item *ngFor="let game of games; let i = index;" (click)="handleClickedGame(i)">
            <mat-icon *ngIf="game.currentTurn" class="color-green" matListIcon>stay_current_landscape</mat-icon>
            <mat-icon *ngIf="!game.currentTurn" class="color-red" matListIcon>stay_current_landscape</mat-icon>
            <h3 matLine>Simple War against {{game.opponentName}}</h3>
            <p matLine>Score: {{game.points}} vs. {{game.opponentPoints}}</p>
          </mat-list-item>
        </mat-list>
        <p *ngIf="games.length === 0">You have no active Simple Wars. Start a new one!</p>
        <mat-divider></mat-divider>
        <br/>
        <button (click)="startGame()" class="fill-width-btn" color="primary" mat-raised-button>Start new Simple War</button>
      </div>

      <!-- One Game -->
      <div *ngIf="inGameMode" class="content-center">

        <!-- Back Button -->
        <button (click)="handleClickedBack()" class="fill-width-btn" mat-raised-button>Back to Games List</button>
        <br/><br/>

        <!-- Game Stats -->
        <mat-chip-list>
          <mat-chip>Opponent: {{activeGame.opponentName}}</mat-chip>
          <mat-chip>Status: {{activeGame.status}}</mat-chip> 
          <mat-chip>Score: {{activeGame.points}} vs. {{activeGame.opponentPoints}}</mat-chip>
          <mat-chip>My Turn: {{activeGame.currentTurn}}</mat-chip>
          <mat-chip>Energy: {{activeGame.energy}}</mat-chip>
          <mat-chip>Number of Cards Played: {{activeGame.numCardsPlayed}}</mat-chip>
          <mat-chip>Number of Turns: {{activeGame.numTurns}}</mat-chip>
          <mat-chip>Created: {{activeGame.createdDate}}</mat-chip>
          <mat-chip>Player2 Joined : {{activeGame.player2JoinDate}}</mat-chip>
          <mat-chip>Last Modified: {{activeGame.lastModifiedDate}}</mat-chip>
          <mat-chip>Completed: {{activeGame.completedDate}}</mat-chip>
        </mat-chip-list>
        <br/><br/>

        <!-- Game Board -->
        <mat-grid-list [cols]="activeGame.numCols">
          <mat-grid-tile class="cell" *ngFor="let cell of activeGameCells; let i = index;" (click)="handleClickedCell(i)">
            <div *ngIf="cell.state==='OCCUPIED'; then showCard else showNothing"></div>
            <ng-template #showCard>
                <button *ngIf="cell.state==='OCCUPIED' && cell.card.owner===activeGame.username" color="accent" [matBadge]="cell.card.might" matBadgePosition="above before" mat-fab>{{cell.card.type}}</button>
                <button *ngIf="cell.state==='OCCUPIED' && cell.card.owner===activeGame.opponentName" color="warn" [matBadge]="cell.card.might" matBadgePosition="above before" mat-fab>{{cell.card.type}}</button>
              </ng-template>
            <ng-template #showNothing></ng-template>
          </mat-grid-tile>
        </mat-grid-list>
        <br/>

        <!-- Cards in Hand -->
        <button *ngFor="let card of activeGame.cards; let i = index;" color="accent" [matBadge]="card.cost" matBadgePosition="below after" (click)="handleClickedCard(card, i)" mat-fab>
          {{card.type}}
        </button>
        <br/><br/>

        <!-- End Turn / Discard Hand Buttons -->
        <button *ngIf="activeGame.currentTurn" (click)="endTurn(false)" class="fill-width-btn" mat-raised-button>End Turn</button>
        <br/><br/>
        <button *ngIf="activeGame.currentTurn" (click)="endTurn(true)" class="fill-width-btn" mat-raised-button>Discard Hand and End Turn</button>

      </div>
    </div>

    <!-- Logged out content -->
    <div *appShowAuthed="false">
      Log in or register to see more content :)
    </div>

  </div>
</div>
