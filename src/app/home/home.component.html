<div class="home-page">

  <div class="banner" *appShowAuthed="false">
    <div class="container">
      <h1 class="logo-font">Simple War</h1>
      <p>Play a friendly game of Simple War!</p>
      <p *appShowAuthed="true">Welcome {{currentUser.username}}!</p>
    </div>
  </div>

  <div class="banner" *appShowAuthed="true">
    <div class="container">
      <h1 class="logo-font">Simple War</h1>
      <p *appShowAuthed="true">Welcome {{currentUser.username}}!</p>
    </div>
  </div>

  <div class="container page">

    <!-- Logged in content -->
    <div class="row" *appShowAuthed="true">
      <!-- <div id="main-panel" class="col-md-9 panel">

        <div *ngIf="activeGame">

          <h3 *ngIf="activeGame.opponentName">{{ activeGame.username }} vs. {{ activeGame.opponentName }}</h3>
          <h3 *ngIf="!activeGame.opponentName">{{ activeGame.username }}'s new Simple War</h3>

          <div id="game-stats">
            <p *ngIf="activeGame.currentTurn && activeGame.status === 'IN_PROGRESS'">Status: My Turn</p>
            <p *ngIf="!activeGame.currentTurn && activeGame.status === 'IN_PROGRESS'">Status: Opponent's Turn</p>
            <p *ngIf="activeGame.status === 'COMPLETED'">Status: Game Over.</p>

            <p>Energy: {{activeGame.energy}} || My Points: {{activeGame.points}} || Opponent's Points: {{activeGame.opponentPoints}} || Turns: {{activeGame.numTurns}} || Cards Played: {{activeGame.numCardsPlayed}}</p>
          </div>

          <table>
            <tr *ngFor="let rowNum of numRows">
                <td *ngFor="let colNum of numCols" (click)="processClickedCell(rowNum, colNum)" 
                    [ngClass]="[(activeGame.currentTurn && (rowNum >= activeGame.board.length-2)) ? 'playable' : '', (activeGame.board[rowNum][colNum].card && activeGame.board[rowNum][colNum].card.owner === activeGame.username) ? 'mine' : 'notmine']">
                  <p *ngIf="activeGame.board[rowNum][colNum].card">{{activeGame.board[rowNum][colNum].card.type}}</p>
                  <p *ngIf="activeGame.board[rowNum][colNum].card">Might: {{activeGame.board[rowNum][colNum].card.might}}</p>
                </td>
              </tr>
          </table>

          <div id="hand">
            <div id="card" *ngFor="let card of activeGame.cards" [ngClass]="[card.clicked ? 'highlight-card' : '', card.justDrew ? 'just-drew' : '']" (click)="processClickedCard(card)">
              <p>{{card.type}}</p>
              <p>Cost: {{card.cost}}</p>
              <p>Might: {{card.might}}</p>
            </div>            
          </div>

          <div id="end-turn-btn-div">
            <button *ngIf="activeGame.currentTurn" id="end-turn-btn" (click)="endTurn()">End Turn</button>          
          </div>

        </div>

      </div>

      <div id="side-panel" class="col-md-3 panel">
          <h3>Your Wars [{{games.length}}]</h3>
          <p *ngIf="games.length == 0">You are in 0 Simple Wars... start a new one!</p>
  
          <ul class="games-list" *ngIf="games">
            <li *ngFor="let game of games" (click)="setActiveGame(game)">
                {{ game.status }} - {{ game.username }} vs. {{ game.opponentName }}
            </li>
          </ul>

          <button *ngIf="!activeGame" (click)="startGame()">Start New War</button>
          
          <hr/>

          <h3>Your Completed Wars [{{completedGames.length}}]</h3>
          <ul class="games-list" *ngIf="completedGames">
              <li *ngFor="let game of completedGames">
                  {{ game.username }} vs. {{ game.opponentName }} - {{ game.points }} to {{ game.opponentPoints }}
              </li>
            </ul>
      </div> -->

      <div *ngIf="!inGameMode">
        <mat-list>
            <mat-list-item *ngFor="let game of games; let i = index;" (click)="handleClickedGame(i)">
              <mat-icon *ngIf="game.currentTurn" class="color-green" matListIcon>stay_current_landscape</mat-icon>
              <mat-icon *ngIf="!game.currentTurn" class="color-red" matListIcon>stay_current_landscape</mat-icon>
              <h3 matLine>Simple War against {{game.opponentName}}</h3>
              <h4 matLine>Status: {{game.status}}</h4>
              <p matLine>Score: {{game.points}} vs. {{game.opponentPoints}}</p>
            </mat-list-item>
          </mat-list>
      </div>

      <div *ngIf="inGameMode">
        <button (click)="handleClickedBack()">Back to Games List</button>
        <mat-grid-list [cols]="activeGame.numCols">
          <mat-grid-tile class="cell" *ngFor="let cell of activeGameCells">
            <div *ngIf="cell.card">
                <mat-grid-tile-header>{{cell.card.type}}</mat-grid-tile-header>
                <mat-grid-tile-footer>{{cell.card.might}}</mat-grid-tile-footer>
            </div>
          </mat-grid-tile>
        </mat-grid-list>

        <mat-grid-list [cols]="activeGame.cards.length">
            <mat-grid-tile *ngFor="let card of activeGame.cards" matBadge="card.cost">
                <mat-grid-tile-header>{{card.type}}</mat-grid-tile-header>
                <mat-grid-tile-footer>{{might}}</mat-grid-tile-footer>
            </mat-grid-tile>
          </mat-grid-list>

        <button (click)="">End Turn</button>
        <button (click)="">Discard Hand and End Turn</button>
      </div>
    </div>

    <!-- Logged out content -->
    <div class="row" *appShowAuthed="false">
      Log in or register to see more content :)
    </div>

  </div>
</div>
